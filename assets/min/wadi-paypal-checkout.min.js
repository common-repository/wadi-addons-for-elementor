/*! For license information please see wadi-paypal-checkout.min.js.LICENSE */
!function(){"use strict";function a(r){var e="https://www.paypal.com/sdk/js";r.sdkBaseURL&&(e=r.sdkBaseURL,delete r.sdkBaseURL),function(e){var t=e["merchant-id"],n=e["data-merchant-id"],r="",o="";Array.isArray(t)?1<t.length?(r="*",o=t.toString()):r=t.toString():"string"==typeof t&&0<t.length?r=t:"string"==typeof n&&0<n.length&&(r="*",o=n);e["merchant-id"]=r,e["data-merchant-id"]=o}(r);var t,n,o=Object.keys(r).filter(function(e){return void 0!==r[e]&&null!==r[e]&&""!==r[e]}).reduce(function(e,t){var n=r[t].toString();return"data-"===t.substring(0,5)?e.dataAttributes[t]=n:e.queryParams[t]=n,e},{queryParams:{},dataAttributes:{}}),a=o.queryParams,o=o.dataAttributes;return{url:"".concat(e,"?").concat((t=a,n="",Object.keys(t).forEach(function(e){0!==n.length&&(n+="&"),n+=e+"="+t[e]}),n)),dataAttributes:o}}function u(e,t){void 0===t&&(t={});var n=document.createElement("script");return n.src=e,Object.keys(t).forEach(function(e){n.setAttribute(e,t[e]),"data-csp-nonce"===e&&n.setAttribute("nonce",t["data-csp-nonce"])}),n}function i(e,t){if(s(e,t=void 0===t?l():t),"undefined"==typeof window)return t.resolve(null);var n=a(e),r=n.url,e=n.dataAttributes,o=e["data-namespace"]||"paypal",n=c(o);return function(e,t){var n=document.querySelector('script[src="'.concat(e,'"]'));if(null!==n){var r=u(e,t),o=n.cloneNode();if(delete o.dataset.uidAuto,Object.keys(o.dataset).length===Object.keys(r.dataset).length){var a=!0;return Object.keys(o.dataset).forEach(function(e){o.dataset[e]!==r.dataset[e]&&(a=!1)}),a&&n}}}(r,e)&&n?t.resolve(n):function(e,t){void 0===t&&(t=l());s(e,t);var i=e.url,c=e.attributes;if("string"!=typeof i||0===i.length)throw new Error("Invalid url.");if(void 0===c||"object"==typeof c)return new t(function(e,n){if("undefined"==typeof window)return e();var t,r,o,a;r=(t={url:i,attributes:c,onSuccess:function(){return e()},onError:function(){var t=new Error('The script "'.concat(i,'" failed to load.'));return window.fetch?fetch(i).then(function(e){return 200===e.status&&n(t),e.text()}).then(function(e){var t=(e=(t=e).split("/* Original Error:")[1])?e.replace(/\n/g,"").replace("*/","").trim():t;n(new Error(t))}).catch(function(e){n(e)}):n(t)}}).url,o=t.attributes,a=t.onSuccess,t=t.onError,(o=u(r,o)).onerror=t,o.onload=a,document.head.insertBefore(o,document.head.firstElementChild)});throw new Error("Expected attributes to be an object.")}({url:r,attributes:e},t).then(function(){var e=c(o);if(e)return e;throw new Error("The window.".concat(o," global variable is not available."))})}function l(){if("undefined"==typeof Promise)throw new Error("Promise is undefined. To resolve the issue, use a Promise polyfill.");return Promise}function c(e){return window[e]}function s(e,t){if("object"!=typeof e||null===e)throw new Error("Expected an options object.");if(void 0!==t&&"function"!=typeof t)throw new Error("Expected PromisePonyfill to be a function.")}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function t(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function v(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?t(Object(o),!0).forEach(function(e){var t,n;t=r,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function d(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(n);return function(e,t){{if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var n=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(o,elementorModules.frontend.handlers.Base);var e,t,n,r=f(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.apply(this,arguments)}return e=o,(t=[{key:"getDefaultSettings",value:function(){return{selectors:{wadiPayPalCheckoutContainer:".wadi_paypal_checkout_container"}}}},{key:"getDefaultElements",value:function(){var e=this.getSettings("selectors");return{$wadiPayPalCheckoutContainerElem:this.findElement(e.wadiPayPalCheckoutContainer)}}},{key:"bindEvents",value:function(){this.initiate()}},{key:"initiate",value:function(){var e=this.getElementSettings(),e=(elementorFrontend.getCurrentDeviceMode(),this.getSettings("selectors"),{wadiPayPalCheckoutContainers:document.querySelectorAll(".wadi_paypal_checkout_container"),wadiPayPalCheckoutContainer:document.querySelector(".wadi_paypal_checkout_container_"+this.$element[0].getAttribute("data-id")),wadiPaypalButtonStyleLayout:e.wadi_paypal_checkout_paypal_buttons_layout||"vertical",wadiPaypalButtonStyleColor:e.wadi_paypal_checkout_paypal_buttons_color||"gold",wadiPaypalButtonStyleShape:e.wadi_paypal_checkout_paypal_buttons_shape||"rect",wadiItemsRepeater:e.wadi_paypal_checkout_preset_amount_to_donate||[]});this.wadiPayPalCheckout(e)}},{key:"wadiPayPalCheckout",value:function(e){var t,n,b;e.wadiPayPalCheckoutContainers[0].dataset.paypalSettings&&(n=JSON.parse(e.wadiPayPalCheckoutContainers[0].dataset.paypalSettings).client_id),e.wadiPayPalCheckoutContainers[0].dataset.paypalSettings&&(b=JSON.parse(e.wadiPayPalCheckoutContainers[0].dataset.paypalSettings).currency);try{t=i({"client-id":n,currency:b,"disable-funding":"card"})}catch(e){console.error("failed to load the PayPal JS SDK script",e)}var r=d(e.wadiPayPalCheckoutContainers),m=this;r&&t.then(function(_){if(_)try{r.forEach(function(n,e){var c,o,u,t=JSON.parse(n.dataset.paypalButtonSettings),l=JSON.parse(n.dataset.paypalSettings),r="yes"==t.tagline,s=b||l.widget_currency,d="yes"===l.shipping_available?Number(l.product_shipping.toFixed(2)):0,y="yes"===l.handling_available?Number(l.product_handling.toFixed(2)):0,p="yes"===l.insurance_available?Number(l.product_insurance.toFixed(2)):0,f="yes"===l.discount_shipping_available?Number(l.shipping_discount_amount.toFixed(2)):0;l.preset_quantity?c=l.preset_quantity:("DONATION"===l.item_category&&"yes"!==l.is_checkout_qty&&(c=1),"yes"===l.is_checkout_qty&&("radio"==l.checkout_qty_type?(o=n.querySelector(".wadi_radio_buttons").querySelectorAll("label")).forEach(function(e,t){var n,r;o[0]&&(o[0].querySelector("input").checked=!0,n=o[0].querySelector("input:checked").value,c=Number(n)),e&&e.addEventListener("click",function(e){r=e.target.value,c=Number(r)})}):"select"==l.checkout_qty_type?(i=n.querySelector(".wadi_checkout_qty").value,c=i,n.querySelector(".wadi_checkout_qty").addEventListener("change",function(e){e=e.target.value;c=Number(e)})):"input"==l.checkout_qty_type&&(i=n.querySelector(".wadi_checkout_qty").value,c=i,n.querySelector(".wadi_checkout_qty").addEventListener("input",function(e){e=e.target.value;c=Number(e)})))),"tax_percentage"==l.is_taxed?u=Number(l.item_price*l.item_tax_percentage)/100:"no_tax"==l.is_taxed&&(u=0);var a=Number(l.item_price.toFixed(2)),i=Number(u.toFixed(2)),a=Number((c*a).toFixed(2)),h=(Number((c*i).toFixed(2)),"yes"===l.offer_discount?Number((a*l.discount_percentage/100).toFixed(2)):0);_.Buttons({style:v({layout:t.layout,color:t.color,shape:t.shape,height:t.height,label:t.label},"vertical"!=t.layout&&{tagline:r}),createOrder:function(e,t){var n=Number(u.toFixed(2)),r=Number(l.item_price.toFixed(2)),o=Number((c*r).toFixed(2)),a=Number((c*n).toFixed(2)),i=Number((o+a+d+y+p-f-h).toFixed(2));return t.order.create({purchase_units:[{amount:{value:i,breakdown:v(v({item_total:{currency_code:s,value:o}},"yes"===l.offer_discount&&{discount:{currency_code:s,value:h}}),{},{handling:{currency_code:s,value:y},insurance:{currency_code:s,value:p},shipping:{currency_code:s,value:d},shipping_discount:{currency_code:s,value:f}},"tax_percentage"==l.is_taxed&&{tax_total:v({currency_code:s},u&&{value:a})})},items:[v(v({name:l.item_name||"Wadi Product",unit_amount:{currency_code:s,value:r||5},quantity:c||1},"tax_percentage"==l.is_taxed&&{tax:v({currency_code:s},u&&{value:n})}),{},{description:l.item_description||"Widget for Elementor",sku:l.item_name||"Digital Product From Wadiweb",category:l.item_category||"DIGITAL_GOODS"})],payee:{email_address:l.paypal_account}}]})},onApprove:function(e,t){return t.order.capture().then(function(e){m.paymentSuccess(n),console.log("on Approve details",e),console.log("Transaction completed by "+e.payer.name.given_name)})},onCancel:function(e,t){console.log("cancel data",e),console.log("Order [".concat(e.orderID,"] was canncelled.")),console.log("Cancel actions ",t)}}).render(n.querySelector("#wadi_paypal_checkout_paypal_button"))})}catch(e){console.error("failed to render the PayPal Buttons",e)}})}},{key:"paymentSuccess",value:function(e){var t=document.createElement("div");t.textContent="Payment was successful.",t.classList.add("wadi_payment_success","hidden"),e.append(t),t.classList.contains("hidden")&&(t.classList.remove("hidden"),setTimeout(function(){t.classList.add("hidden")},5e3))}}])&&y(e.prototype,t),n&&y(e,n),o}();jQuery(window).on("elementor/frontend/init",function(){elementorFrontend.hooks.addAction("frontend/element_ready/wadi-paypal-checkout-addon.default",function(e){elementorFrontend.elementsHandler.addHandler(n,{$element:e})})})}();
//# sourceMappingURL=wadi-paypal-checkout.min.js.map